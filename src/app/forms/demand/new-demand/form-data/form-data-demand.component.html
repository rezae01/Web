<form action="" method="post" [formGroup]="NewDemand" novalidate  name="NewDemand" (ngSubmit)="createTable()">
  <div class="row">
    <div class="tab-content" id="IntegraSeparation">
      <div role="tabpanel" class="tab-pane active" id="Parent-Step1">
        <div class="col-xs-12">
          <div class="row">
            <div class="col-xs-12 col-sm-4 col-md-3" style="height:80px;">
              <div class="form-group">
                <label for="requestId"> شماره درخواست </label>
                <input class="form-control" type="text" id="requestId" [value]="requestId" disabled="disabled">
              </div>
            </div>
            <div class="col-xs-12 col-sm-3" style="height:80px;">
              <div class="form-group">
                <label for="regionName">امور</label>
                <input class="form-control" name="regionName" id="regionName" [value]="regionName" disabled="disabled">
              </div>
            </div>
            <div class="col-xs-12 col-sm-3" style="height:80px;">
              <div class="form-group">
                <label for="cityName">بخش</label>
                <input class="form-control" name="cityName" id="cityName" [value]="cityName" disabled="disabled">
              </div>
            </div>
            <div class="col-xs-12 col-sm-4 col-md-3" style="height:80px;">
              <div class="form-inline">
                <div class="form-group">
                  <label for="requestDate">تاریخ درخواست</label>
                  <div class="input-group" style="width:100%;">
                    <input class="form-control" placeholder="yyyy-mm-dd" [value]="requestDate" id="requestDate" disabled="disabled">
                    <div class="input-group-addon" (click)="d.toggle()" id="checkboxOff">
                      <img src="./../../assets/img/calendar-icon.svg" style="width: 1.2rem; height: 1rem; cursor: pointer;"/>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <fieldset class="col-xs-12">
            <div class="row">
              <div id="UI-Valid-Panel" formArrayName="CalculationData">
                <div class="panel panel-default" *ngFor="let itemrow of NewDemand.controls.CalculationData.controls; let i=index">
                  <div class="panel-heading">
                    <span>فرم  {{i + 1}}</span>
                    <span class="glyphicon glyphicon-remove pull-left" *ngIf="NewDemand.controls.CalculationData.controls.length > 1" (click)="RemoveDemand(i)"></span>
                  </div> 
                  <div class="panel-body" [formGroupName]="i">
                    <div class="col-xs-12 col-sm-3" style="height:80px;">
                      <div class="form-group">
                        <label for="TrfType">نوع انشعاب</label>
                        <select id="TrfType" class="form-control" name="TrfType" formControlName="TrfType" style="width:100%;" required> 
                          <option [value]="1">آزاد و موقت</option>
                          <option [value]="0">دائم </option>
                        </select>
                        <small *ngIf="NewDemand.controls.CalculationData.controls[i].controls.TrfType.touched && NewDemand.controls.CalculationData.controls[i].controls.TrfType.hasError('required')" class="mat-text-warn">فیلد شما خالی میباشد</small>  
                      </div>
                    </div>
                    <div class="col-xs-12 col-sm-3" style="height:80px;">
                      <div class="form-group">
                        <label for="Phs">فاز</label>
                        <select id="Phs" class="form-control" name="Phs" formControlName="Phs" style="width:100%;" required>
                          <option [value]="1">تک فاز</option>
                          <option [value]="3">سه فاز</option> 
                        </select>
                        <small *ngIf="NewDemand.controls.CalculationData.controls[i].controls.Phs.touched && NewDemand.controls.CalculationData.controls[i].controls.Phs.hasError('required')" class="mat-text-warn">فیلد شما خالی میباشد</small>
                      </div>
                    </div>
                    <div class="col-xs-12 col-sm-3" style="height:80px;">
                      <div class="form-group">
                        <label for="Amper">آمپر</label>
                        <select id="Amp" name="Amp" formControlName="Amp" class="form-control" required>
                          <option [value]="0">0</option>
                          <option [value]="5">5</option>
                          <option [value]="10">10</option>
                          <option [value]="15">15</option>
                          <option [value]="25">25</option>
                          <option [value]="32">32</option>
                          <option [value]="50">50</option>
                          <option [value]="75">75</option>
                          <option [value]="100">100</option>
                          <option [value]="125">125</option>
                          <option [value]="150">150</option>
                          <option [value]="151">107</option>
                          <option [value]="200">200</option>
                          <option [value]="250">250</option>
                          <option [value]="300">300</option>
                          <option [value]="400">400</option> 
                        </select>
                        <small *ngIf="NewDemand.controls.CalculationData.controls[i].controls.Amp.touched && NewDemand.controls.CalculationData.controls[i].controls.Amp.hasError('required')" class="mat-text-warn">فیلد شما خالی میباشد</small>
                      </div>
                    </div>
                    <div class="col-xs-12 col-sm-3" style="height:80px;">
                      <div class="form-group">
                        <label for="TrfHCode">سر تعرفه</label>
                        <select id="TrfHCode" name="TrfHCode" formControlName="TrfHCode" class="form-control" required>
                          <option [value]="1" class="hideOption">خانگی</option>
                          <option [value]="2" id="stepOne">عمومی</option>
                          <option [value]="3" id="stepTwo">کشاورزی</option>
                          <option [value]="4" class="hideOption">صنعت و معدن</option>
                          <option [value]="5" class="hideOption">سایر مصارف</option>  
                        </select>
                        <small *ngIf="NewDemand.controls.CalculationData.controls[i].controls.TrfHCode.touched && NewDemand.controls.CalculationData.controls[i].controls.TrfHCode.hasError('required')" class="mat-text-warn">فیلد شما خالی میباشد</small>
                      </div>
                    </div>
                    <div class="col-xs-12 col-sm-3 stepOne" style="height:80px;">
                      <div class="form-group">
                        <label for="TrfDetailCode">ریز تعرفه</label>
                        <select class="form-control" id="TrfDetailCode" name="TrfDetailCode" formControlName="TrfDetailCode">
                          <option [value]="0" selected>عادی</option>
                          <option [value]="1">جایگاه CNG</option>
                          <option [value]="1">کشاورزی پمپاژ</option>
                          <option [value]="2">صنایع کشاورزی</option>
                          <option [value]="3">چاه کشاورزی</option>
                        </select>
                        <small *ngIf="NewDemand.controls.CalculationData.controls[i].controls.TrfDetailCode.touched && NewDemand.controls.CalculationData.controls[i].controls.TrfDetailCode.hasError('required')" class="mat-text-warn">فیلد شما خالی میباشد</small>                  
                      </div>
                    </div>
                    <div class="col-xs-12 col-sm-3" style="height:80px;">
                      <div class="form-group">
                        <label for="VoltCode">ولتاژ</label>
                        <select class="form-control" id="VoltCode" name="VoltCode" formControlName="VoltCode" required>
                          <option [value]="1">اولیه</option>
                          <option [value]="2">ثانویه</option>
                        </select> 
                        <small *ngIf="NewDemand.controls.CalculationData.controls[i].controls.VoltCode.touched && NewDemand.controls.CalculationData.controls[i].controls.VoltCode.hasError('required')" class="mat-text-warn">فیلد شما خالی میباشد</small>
                      </div>
                    </div>
                    <div class="col-xs-12 col-sm-3" style="height:80px;">
                      <div class="form-group">
                        <label for="PwrCnt">قدرت درخواستی</label>
                        <input class="form-control" type="text" id="PwrCnt" name="PwrCnt" formControlName="PwrCnt" onkeypress="return isNumber(event)" required>
                        <small *ngIf="NewDemand.controls.CalculationData.controls[i].controls.PwrCnt.touched && NewDemand.controls.CalculationData.controls[i].controls.PwrCnt.hasError('required')" class="mat-text-warn">فیلد شما خالی میباشد</small>
                      </div>
                    </div>
                    <div class="col-xs-12 col-sm-3" style="height:80px;">
                      <div class="form-group">
                        <label for="PwrIcn">قدرت مجاز پروانه</label>
                        <input class="form-control" type="text" id="PwrIcn" name="PwrIcn" formControlName="PwrIcn" onkeypress="return isNumber(event)" required>
                        <small *ngIf="NewDemand.controls.CalculationData.controls[i].controls.PwrIcn.touched && NewDemand.controls.CalculationData.controls[i].controls.PwrIcn.hasError('required')" class="mat-text-warn">فیلد شما خالی میباشد</small>
                      </div>
                    </div>
                    <div class="col-xs-12 col-sm-3" style="height:80px;">
                      <div class="form-group">
                        <label for="FmlCode">تعداد خانوار</label>
                        <input class="form-control" type="text" id="FmlCode" name="FmlCode" formControlName="FmlCode" onkeypress="return isNumber(event)" required>
                        <small *ngIf="NewDemand.controls.CalculationData.controls[i].controls.FmlCode.touched && NewDemand.controls.CalculationData.controls[i].controls.FmlCode.hasError('required')" class="mat-text-warn">فیلد شما خالی میباشد</small>
                      </div>
                    </div>  
                    <div class="col-xs-12 col-sm-3" style="height:80px;">
                      <div class="form-group">
                        <label for="Count">تعداد انشعاب</label>
                        <input class="form-control" type="text" id="Count" name="Count" formControlName="Count" onkeypress="return isNumber(event)" required>
                        <small *ngIf="NewDemand.controls.CalculationData.controls[i].controls.Count.touched && NewDemand.controls.CalculationData.controls[i].controls.Count.hasError('required')" class="mat-text-warn">فیلد شما خالی میباشد</small>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </fieldset>   
        </div>
      </div>
      <div class="col-xs-12">
        <div class="col-xs-12">
          <div class="row">
            <button md-raised-button type="button" (click)="AddDemand()" class="btn btn-info mb-10">
              <i class="fa fa-plus" aria-hidden="true"></i>
              انشعاب جدید
            </button>
            <button md-raised-button type="button" class="btn btn-success mb-10" [disabled]="!NewDemand.valid" (click)="createTable()">
              <i class="fa fa-check-square-o" aria-hidden="true"></i>
              ثبت
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</form>